# 支付宝账单分析系统使用说明

## 1. 系统概述

支付宝账单分析系统是一个基于 Flask 和 ECharts 的可视化分析工具，帮助用户深入了解个人消费情况。系统支持多维度分析，包括年度、月度、分类、时间等多个维度。

## 2. 功能特点

### 2.1 数据分析维度
- 年度总览：年度收支情况、消费趋势、分类占比
- 月度分析：月度支出趋势、环比变化、移动平均
- 分类分析：消费分类占比、分类趋势
- 时间分析：日消费热力图、时段分布、工作日/周末对比

### 2.2 数据筛选功能
- 全部交易分析
- 大额交易分析（>1000元）
- 小额交易分析（≤1000元）

## 3. 使用流程

### 3.1 准备数据

#### Alipay (支付宝)
1. 登录支付宝网页版或 App
2. 进入账单页面 -> 申请开具交易流水证明 -> 用于个人对账
3. 选择时间范围（最长一年）
4. 下载 CSV 格式账单（无需修改文件内容）

#### WeChat (微信)
1. 打开微信 App -> 我 -> 服务 -> 钱包 -> 账单
2. 点击常见问题 -> 下载账单 -> 用于个人对账
3. 选择时间范围（最长三个月）
4. 下载压缩包解压后获取 XLSX 或 CSV 格式账单

### 3.2 上传数据
1. 打开系统首页或点击"上传账单文件"进入设置页
2. 页面分为左右两个区域：
   - **左侧**：支付宝账单上传区（仅支持 .csv）
   - **右侧**：微信账单上传区（支持 .xlsx 和 .csv）
3. 将对应文件拖拽至相应区域或点击选择文件
4. 等待文件上传并处理完成

### 3.3 查看分析
1. 年度总览
   - 查看年度收支情况
   - 分析消费趋势
   - 了解分类占比

2. 月度分析
   - 查看月度支出趋势
   - 对比环比变化
   - 观察移动平均线

3. 分类分析
   - **分源展示**：自动将分类按“支付宝”和“微信”渠道分组展示
   - **智能排序**：基于金额(70%)和频次(30%)的加权排序，优先展示重要分类
   - 查看消费分类占比和趋势变化
   - 查看详细交易记录

4. 时间分析
   - 查看消费热力图
   - 分析时段分布
   - 对比工作日/周末消费

## 4. 注意事项

### 4.1 数据安全
- **私有化分析**：所有计算均在服务器内存中进行，不写入数据库。
- **临时存储**：上传的账单文件仅在 `/tmp` 目录临时保存，与您的会话隔离。
- **自动销毁**：
  - 前端会话结束后自动清理。
  - 后台每小时运行清理任务，物理删除所有过期文件。

### 4.2 文件要求
- **支付宝**：CSV 格式，GBK 编码
- **微信**：XLSX 或 CSV 格式
- 文件大小限制为 16MB

### 4.3 浏览器支持
- 推荐使用 Chrome、Firefox、Safari 最新版本
- 需要启用 JavaScript
- 建议使用桌面设备访问以获得最佳体验

## 5. 快捷操作

### 5.1 数据筛选
- 点击金额筛选按钮快速切换视图（全部/大额/小额）
- 使用日期选择器查看特定时期数据
- 通过搜索框快速定位交易记录
- 点击图表元素查看详细交易记录
  - 支持按金额范围筛选
  - 支持按工作日/周末筛选
  - 支持组合筛选条件

### 5.2 图表交互
- 点击图例显示/隐藏数据系列
- 使用鼠标滚轮缩放图表
- 双击图表恢复默认视图

### 5.3 数据导出
- 点击图表右上角按钮保存图片
- 在交易记录页面导出数据
- 支持多种导出格式

## 6. 故障排除

### 6.1 上传失败
- 检查文件格式是否正确
- 确认文件编码为 GBK
- 验证文件大小是否超限

### 6.2 数据显示异常
- 刷新页面重新加载
- 清除浏览器缓存
- 重新上传账单文件

### 6.3 页面加载缓慢
- 检查网络连接
- 关闭其他标签页
- 清理浏览器缓存 